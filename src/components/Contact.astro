<div
  id="contact"
  class="mt-24 pt-44 flex justify-between items-center flex-col md:flex-row gap-y-12"
>
  <section class="fade-right flex flex-col justify-center">
    <h2
      class="text-2xl md:text-3xl lg:text-4xl text-center md:text-start xl:text-5xl font-semibold mb-4"
    >
      Contact me!
    </h2>
    <p
      class="md:w-xs lg:w-md xl:w-xl sm:text-lg w-[90%] mx-auto md:mx-0 text-slate-300 mb-6"
    >
      Let's talk! If you have a project, idea, or just want to say hello, fill
      out the form and I'll get back to you as soon as possible.
    </p>
    <a
      href="docs/CV.pdf"
      target="_blank"
      class="px-6 py-3 w-fit mx-auto md:mx-0 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition"
    >
      Download CV
    </a>
  </section>
  <section class="w-full md:w-[45%] fade-left">
    <form
      id="contactForm"
      action="https://formspree.io/f/xeovjldo"
      method="POST"
      class="flex flex-col gap-4 bg-zinc-900/60 p-6 rounded-2xl border border-zinc-800 hover:border-blue-500 transition-all duration-300"
    >
      <input
        type="text"
        name="name"
        placeholder="Name"
        required
        class="px-4 py-2 rounded-lg bg-zinc-800 text-white border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300"
      />
      <input
        type="email"
        name="email"
        placeholder="Email"
        required
        class="px-4 py-2 rounded-lg bg-zinc-800 text-white border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300"
      />
      <textarea
        name="message"
        placeholder="What’s on your mind?"
        required
        rows="5"
        style="resize: none;"
        class="px-4 py-2 rounded-lg bg-zinc-800 text-white border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all duration-300"
      ></textarea>
      <button
        id="sendBtn"
        type="submit"
        class="mt-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-semibold transition-all duration-300"
      >
        Send
      </button>
    </form>
  </section>
  <div
    id="SuccessMessage"
    class="fixed bottom-6 right-6 bg-white/1 border border-white/5 backdrop-blur-xs text-white px-4 py-2 rounded-lg
opacity-0 pointer-events-none transition-opacity duration-500 z-99999"
  >
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const form = document.getElementById("contactForm");
    const msg = document.getElementById("SuccessMessage");
    const btn = document.getElementById("sendBtn");
    if (!(form instanceof HTMLFormElement) || !msg || !btn) return;

    btn.addEventListener("click", async (e) => {
      e.preventDefault();

      const nameInput = form.querySelector(
        'input[name="name"]'
      ) as HTMLInputElement | null;
      const emailInput = form.querySelector(
        'input[name="email"]'
      ) as HTMLInputElement | null;
      const messageInput = form.querySelector(
        'textarea[name="message"]'
      ) as HTMLTextAreaElement | null;

      const name = nameInput?.value.trim() || "";
      const email = emailInput?.value.trim() || "";
      const message = messageInput?.value.trim() || "";

      // Validar campos vacíos
      if (!name || !email || !message) {
        msg.setHTMLUnsafe("Please complete the form.");
        msg.style.opacity = "1";
        setTimeout(() => (msg.style.opacity = "0"), 2500);
        return;
      }

      // Validar formato de correo
      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        msg.setHTMLUnsafe("Please enter a valid email.");
        msg.style.opacity = "1";
        setTimeout(() => (msg.style.opacity = "0"), 2500);
        return;
      }

      const formData = new FormData(form);

      try {
        const response = await fetch(form.action, {
          method: "POST",
          body: formData,
          headers: { Accept: "application/json" },
        });

        if (response.ok) {
          msg.setHTMLUnsafe("Email sent successfully!");
          msg.style.opacity = "1";
          setTimeout(() => {
            msg.style.opacity = "0";
          }, 2500);
          form.reset();
        } else {
          msg.setHTMLUnsafe("error sending email.");
          msg.style.opacity = "1";
          setTimeout(() => {
            msg.style.opacity = "0";
          }, 2500);
        }
      } catch (err) {
        msg.setHTMLUnsafe("error sending email (server fail).");
        console.log(err);
        msg.style.opacity = "1";
        setTimeout(() => {
          msg.style.opacity = "0";
        }, 2500);
      }
    });
  });
</script>
